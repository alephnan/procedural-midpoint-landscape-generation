(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
var Node = (function () {
    function Node(data) {
        this.prev = null;
        this.next = null;
        this.data = data;
    }
    return Node;
}());
exports.Node = Node;
var LinkedList = (function () {
    function LinkedList() {
        this.first = null;
        this.last = null;
        this.length_ = 0;
    }
    LinkedList.prototype.length = function () {
        return this.length_;
    };
    LinkedList.prototype.get = function (index) {
        return this.getNode(index).data;
    };
    LinkedList.prototype.getNode = function (index) {
        var i = 0;
        var curr = this.first;
        while (curr != null) {
            if (i == index) {
                break;
            }
            curr = curr.next;
            i++;
        }
        if (i != index) {
            throw Error('Invalid index');
        }
        return curr;
    };
    LinkedList.prototype.pop = function () {
        if (!(this.first)) {
            throw new Error("Nothing to pop");
        }
        var node = this.first;
        if (node.next == null) {
            this.first = null;
        }
        else {
            this.first = node.next;
            this.first.prev = null;
        }
        this.length_--;
        return node.data;
    };
    LinkedList.prototype.push = function (e) {
        var n = new Node(e);
        if (this.last == null) {
            this.first = n;
            this.last = n;
        }
        else {
            this.last.next = n;
            n.prev = this.last;
            this.last = n;
        }
        this.length_++;
    };
    LinkedList.prototype.peekLast = function () {
        return this.last.data;
    };
    LinkedList.prototype.forEach = function (f) {
        var i = 0;
        var curr = this.first;
        while (curr != null) {
            f(curr.data);
            curr = curr.next;
            i++;
        }
    };
    LinkedList.prototype.splitAt = function (index, split) {
        if (index < 0) {
            throw Error();
        }
        if (this.first == null) {
            throw Error('Invalid index');
        }
        if (this.first.next == null && index != 0) {
            throw Error('Index DNE');
        }
        if (index >= this.length()) {
            throw Error('Index out bounds');
        }
        this.length_++;
        var leftNode = new Node(split.x);
        var rightNode = new Node(split.y);
        leftNode.next = rightNode;
        rightNode.prev = leftNode;
        if (this.first.next == null) {
            this.first = leftNode;
            this.last = rightNode;
        }
        else if (index == 0) {
            var next = this.first.next;
            rightNode.next = next;
            this.first = leftNode;
            next.prev = rightNode;
        }
        else if (index == this.length() - 2) {
            this.last.prev.next = leftNode;
            leftNode.prev = this.last.prev;
            this.last = rightNode;
        }
        else {
            var curr = this.getNode(index);
            var prev = curr.prev;
            var next = curr.next;
            leftNode.prev = prev;
            rightNode.next = next;
            prev.next = leftNode;
            next.prev = rightNode;
        }
    };
    return LinkedList;
}());
exports.LinkedList = LinkedList;

},{}],2:[function(require,module,exports){
"use strict";
var scrolling_midpoint_displacer_linkedlist_1 = require("./scrolling-midpoint-displacer-linkedlist");
var sketch = function (p) {
    var W = 2000;
    var H = 400;
    var minimumW = 640;
    var maximumH = Math.round(H * .8);
    var mdp = new scrolling_midpoint_displacer_linkedlist_1.ScrollingMidpointDisplacerLinkedList(minimumW, maximumH);
    p.setup = function () {
        p.createCanvas(W, H);
        p.strokeWeight(2);
        p.frameRate(20);
    };
    p.draw = function () {
        p.background(p.color('black'));
        p.stroke(p.color(98, 203, 157));
        mdp.update();
        mdp.render(p);
        p.stroke(p.color('white'));
        p.line(minimumW, 0, minimumW, H);
    };
};
new p5(sketch, false, false);

},{"./scrolling-midpoint-displacer-linkedlist":4}],3:[function(require,module,exports){
"use strict";
var Pair = (function () {
    function Pair(x, y) {
        this.x = x;
        this.y = y;
    }
    Pair.prototype.toString = function () {
        return "Pair(" + this.x + "," + this.y + ")";
    };
    Pair.prototype.shallowClone = function () {
        return new Pair(this.x, this.y);
    };
    return Pair;
}());
exports.Pair = Pair;

},{}],4:[function(require,module,exports){
"use strict";
var pair_1 = require("./pair");
var splittable_line_1 = require("./splittable-line");
var linked_list_1 = require("./linked-list");
var ScrollingMidpointDisplacerLinkedList = (function () {
    function ScrollingMidpointDisplacerLinkedList(minimumWidth, maximumHeight) {
        this.verticalBound = new pair_1.Pair(0, maximumHeight);
        var lines = new linked_list_1.LinkedList();
        this.lineSegments = lines;
        var p1 = new pair_1.Pair(0, 150);
        var p2 = new pair_1.Pair(ScrollingMidpointDisplacerLinkedList.INITIAL_LINE_WIDTH, 250);
        var baseDisplacement = p1.y - p2.y;
        var l = new splittable_line_1.SplittableLine(p1, p2, 0, baseDisplacement);
        lines.push(l);
        var numBaseLineSegments = minimumWidth / ScrollingMidpointDisplacerLinkedList.INITIAL_LINE_WIDTH;
        for (var i = 0; i < numBaseLineSegments; i++) {
            this.enqueue();
        }
        this.enqueueInterval = Math.pow(ScrollingMidpointDisplacerLinkedList.POWER, (ScrollingMidpointDisplacerLinkedList.MAX_GENERATIONS - 1));
        for (var i = 0; i < ScrollingMidpointDisplacerLinkedList.MAX_GENERATIONS; i++) {
            this.displace();
        }
        this.iterations = 0;
    }
    ScrollingMidpointDisplacerLinkedList.prototype.render = function (p) {
        this.lineSegments.forEach(function (l) {
            p.line(l.a.x, l.a.y, l.b.x, l.b.y);
        });
    };
    ScrollingMidpointDisplacerLinkedList.prototype.enqueue = function () {
        var last = this.lineSegments.peekLast();
        var beginCoordinate = new pair_1.Pair(last.b.x + 0, last.b.y + 0);
        var endCoordinate = new pair_1.Pair(beginCoordinate.x +
            ScrollingMidpointDisplacerLinkedList.INITIAL_LINE_WIDTH, Math.floor(this.verticalBound.y * Math.random()));
        var newLine = new splittable_line_1.SplittableLine(beginCoordinate, endCoordinate, 0, beginCoordinate.y - endCoordinate.y);
        this.lineSegments.push(newLine);
    };
    ScrollingMidpointDisplacerLinkedList.prototype.displace = function () {
        var lines = this.lineSegments;
        var i = this.lineSegments.length() - 1;
        while (i >= 0) {
            var l = lines.get(i);
            if (!ScrollingMidpointDisplacerLinkedList.skipSplittableLine(l)) {
                var split = l.getSplit(this.verticalBound);
                lines.splitAt(i, split);
            }
            i--;
        }
    };
    ScrollingMidpointDisplacerLinkedList.prototype.scroll = function () {
        var deltaX = ScrollingMidpointDisplacerLinkedList.MINIMUM_LINE_WIDTH;
        this.lineSegments.forEach(function (l) {
            l.translate(-1 * deltaX, 0);
        });
    };
    ScrollingMidpointDisplacerLinkedList.prototype.update = function () {
        this.iterations++;
        this.lineSegments.pop();
        this.displace();
        if (this.iterations % this.enqueueInterval == 0) {
            this.enqueue();
        }
        this.scroll();
    };
    ScrollingMidpointDisplacerLinkedList.skipSplittableLine = function (l) {
        return l.getGeneration() >= ScrollingMidpointDisplacerLinkedList.MAX_GENERATIONS - 1;
    };
    return ScrollingMidpointDisplacerLinkedList;
}());
ScrollingMidpointDisplacerLinkedList.ROUGHNESS = .8;
ScrollingMidpointDisplacerLinkedList.POWER = 2;
ScrollingMidpointDisplacerLinkedList.MINIMUM_LINE_WIDTH = 2;
ScrollingMidpointDisplacerLinkedList.MAX_GENERATIONS = 7;
ScrollingMidpointDisplacerLinkedList.INITIAL_LINE_WIDTH = (ScrollingMidpointDisplacerLinkedList.MINIMUM_LINE_WIDTH *
    Math.pow(ScrollingMidpointDisplacerLinkedList.POWER, (ScrollingMidpointDisplacerLinkedList.MAX_GENERATIONS - 1)));
exports.ScrollingMidpointDisplacerLinkedList = ScrollingMidpointDisplacerLinkedList;

},{"./linked-list":1,"./pair":3,"./splittable-line":5}],5:[function(require,module,exports){
"use strict";
var pair_1 = require("./pair");
var SplittableLine = (function () {
    function SplittableLine(a, b, generation, baseDisplacement) {
        this.a = a;
        this.b = b;
        this.generation = generation;
        this.baseDisplacement = baseDisplacement;
    }
    SplittableLine.prototype.toString = function () {
        return "Line(" + this.a.toString() + "->" + this.b.toString() + ")";
    };
    SplittableLine.prototype.getMidpoint = function () {
        var x = (this.b.x + this.a.x) / 2;
        var y = (this.b.y + this.a.y) / 2;
        return new pair_1.Pair(x, y);
    };
    SplittableLine.prototype.nextDisplacementMagnitude = function () {
        var baseDisplacementScale = Math.pow(2, (-1 * SplittableLine.ROUGHNESS));
        var displacementScale = Math.pow(baseDisplacementScale, this.generation);
        return this.baseDisplacement * displacementScale;
    };
    SplittableLine.prototype.getGeneration = function () {
        return this.generation;
    };
    SplittableLine.prototype.getBaseDisplacement = function () {
        return this.baseDisplacement;
    };
    SplittableLine.prototype.getSplit = function (verticalBound) {
        var displacementMagnitude = this.nextDisplacementMagnitude();
        var leftPoint = this.a;
        var rightPoint = this.b;
        var midpoint = this.getMidpoint();
        var verticallyDisplacedMidpointA = this.displacePointVertically(midpoint, displacementMagnitude, verticalBound);
        var verticallyDisplacedMidpointB = verticallyDisplacedMidpointA.shallowClone();
        var generation = this.getGeneration() + 1;
        var baseDisplacement = this.getBaseDisplacement();
        var leftSplittableLine = new SplittableLine(leftPoint, verticallyDisplacedMidpointA, generation, baseDisplacement);
        var rightSplittableLine = new SplittableLine(verticallyDisplacedMidpointB, rightPoint, generation, baseDisplacement);
        return new pair_1.Pair(leftSplittableLine, rightSplittableLine);
    };
    SplittableLine.prototype.displacePointVertically = function (p, displaceMagnitude, verticalBound) {
        var y = p.y + this.choose([displaceMagnitude, -displaceMagnitude]);
        y = this.clamp(y, verticalBound.x, verticalBound.y);
        return new pair_1.Pair(p.x, y);
    };
    SplittableLine.prototype.choose = function (choices) {
        return choices[Math.floor(Math.random() * choices.length)];
    };
    SplittableLine.prototype.clamp = function (x, lowerBound, upperBound) {
        return Math.min(upperBound, Math.max(x, lowerBound));
    };
    SplittableLine.prototype.translate = function (x, y) {
        this.a.x += x;
        this.a.y += y;
        this.b.x += x;
        this.b.y += y;
    };
    return SplittableLine;
}());
SplittableLine.ROUGHNESS = .6;
exports.SplittableLine = SplittableLine;

},{"./pair":3}]},{},[2])

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvbGlua2VkLWxpc3QudHMiLCJzcmMvbWFpbi50cyIsInNyYy9wYWlyLnRzIiwic3JjL3Njcm9sbGluZy1taWRwb2ludC1kaXNwbGFjZXItbGlua2VkbGlzdC50cyIsInNyYy9zcGxpdHRhYmxlLWxpbmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FDTUE7SUFLRSxjQUFZLElBQVM7UUFDbkIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDakIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDakIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7SUFDbkIsQ0FBQztJQUNILFdBQUM7QUFBRCxDQVZBLEFBVUMsSUFBQTtBQVZZLG9CQUFJO0FBWWpCO0lBS0U7UUFDRSxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztRQUNsQixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsT0FBTyxHQUFHLENBQUMsQ0FBQztJQUNuQixDQUFDO0lBRUQsMkJBQU0sR0FBTjtRQUNFLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDO0lBQ3RCLENBQUM7SUFFRCx3QkFBRyxHQUFILFVBQUksS0FBYTtRQUNmLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQztJQUNsQyxDQUFDO0lBR08sNEJBQU8sR0FBZixVQUFnQixLQUFhO1FBQzNCLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNWLElBQUksSUFBSSxHQUFVLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDN0IsT0FBTSxJQUFJLElBQUksSUFBSSxFQUFFLENBQUM7WUFDbkIsRUFBRSxDQUFBLENBQUMsQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUM7Z0JBQ2QsS0FBSyxDQUFDO1lBQ1IsQ0FBQztZQUNE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QyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2QsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2QsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2QsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2hCLENBQUM7SUFDSCxxQkFBQztBQUFELENBakZBLEFBaUZDO0FBaEZRLHdCQUFTLEdBQVcsRUFBRSxDQUFDO0FBRG5CLHdDQUFjIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qKlxuICogRG91Ymx5IExpbmtlZCBMaXN0IERhdGEgc3RydWN0dXJlXG4gKi9cbmltcG9ydCB7TGluZX0gZnJvbSAnLi9saW5lJztcbmltcG9ydCB7UGFpcn0gZnJvbSAnLi9wYWlyJztcblxuZXhwb3J0IGNsYXNzIE5vZGUge1xuICBwdWJsaWMgZGF0YTogYW55O1xuICBwdWJsaWMgcHJldjogTm9kZTtcbiAgcHVibGljIG5leHQ6IE5vZGU7XG5cbiAgY29uc3RydWN0b3IoZGF0YTogYW55KSB7XG4gICAgdGhpcy5wcmV2ID0gbnVsbDtcbiAgICB0aGlzLm5leHQgPSBudWxsO1xuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIExpbmtlZExpc3Qge1xuICBwcml2YXRlIGZpcnN0OiBOb2RlO1xuICBwcml2YXRlIGxhc3Q6IE5vZGU7XG4gIHByaXZhdGUgbGVuZ3RoXzogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZmlyc3QgPSBudWxsO1xuICAgIHRoaXMubGFzdCA9IG51bGw7XG4gICAgdGhpcy5sZW5ndGhfID0gMDtcbiAgfVxuXG4gIGxlbmd0aCgpIDogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5sZW5ndGhfO1xuICB9XG5cbiAgZ2V0KGluZGV4OiBudW1iZXIpIDogYW55IHtcbiAgICByZXR1cm4gdGhpcy5nZXROb2RlKGluZGV4KS5kYXRhO1xuICB9XG5cbiAgLy8gVE9ETyhhdXRvbWF0d29uKTogTG9vcCBiYWNrd2FyZCBmcm9tIGVuZCBpZiBjbG9zZXIgdG8gaW5kZXguXG4gIHByaXZhdGUgZ2V0Tm9kZShpbmRleDogbnVtYmVyKSA6IE5vZGUge1xuICAgIGxldCBpID0gMDtcbiAgICBsZXQgY3VyciA6IE5vZGUgPSB0aGlzLmZpcnN0O1xuICAgIHdoaWxlKGN1cnIgIT0gbnVsbCkge1xuICAgICAgaWYoaSA9PSBpbmRleCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGN1cnIgPSBjdXJyLm5leHQ7XG4gICAgICBpKys7XG4gICAgfVxuXG4gICAgaWYoaSAhPSBpbmRleCkge1xuICAgICAgdGhyb3cgRXJyb3IoJ0ludmFsaWQgaW5kZXgnKTtcbiAgICB9XG4gICAgcmV0dXJuIGN1cnI7XG4gIH1cblxuICAvLyBUaHJvd3MgbnVsbCBwb2ludGVyIGlmIG5vIGVsZW1lbnQgdG8gcG9wXG4gIHBvcCgpIDogTGluZSB7XG4gICAgaWYoISh0aGlzLmZpcnN0KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm90aGluZyB0byBwb3BcIik7XG4gICAgfVxuXG4gICAgY29uc3Qgbm9kZSA9IHRoaXMuZmlyc3Q7XG4gICAgaWYobm9kZS5uZXh0ID09IG51bGwpIHtcbiAgICAgIHRoaXMuZmlyc3QgPSBudWxsXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZmlyc3QgPSBub2RlLm5leHQ7XG4gICAgICB0aGlzLmZpcnN0LnByZXYgPSBudWxsO1xuICAgIH1cbiAgICB0aGlzLmxlbmd0aF8tLTtcbiAgICByZXR1cm4gbm9kZS5kYXRhO1xuICB9XG5cbiAgLy8gYmUgc3RyaWN0ZXIgYWJvdXQgdGhlIHR5cGUgdG8gZTogTGluZWBcbiAgcHVzaChlOiBhbnkpIHtcbiAgICBjb25zdCBuID0gbmV3IE5vZGUoZSk7XG4gICAgaWYodGhpcy5sYXN0ID09IG51bGwpIHtcbiAgICAgIHRoaXMuZmlyc3QgPSBuO1xuICAgICAgdGhpcy5sYXN0ID0gbjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5sYXN0Lm5leHQgPSBuO1xuICAgICAgbi5wcmV2ID0gdGhpcy5sYXN0O1xuICAgICAgdGhpcy5sYXN0ID0gbjtcbiAgICB9XG5cbiAgICB0aGlzLmxlbmd0aF8rKztcbiAgfVxuXG4gIC8vIFRPRE8oYXV0b21hdHdvbik6IGFkZCBwZWVrRmlyc3RcblxuICBwZWVrTGFzdCgpIDogYW55IHtcbiAgICByZXR1cm4gdGhpcy5sYXN0LmRhdGE7XG4gIH1cblxuICBmb3JFYWNoKGY6IEZ1bmN0aW9uKSA6IHZvaWQge1xuICAgIGxldCBpID0gMDtcbiAgICBsZXQgY3VyciA6IE5vZGUgPSB0aGlzLmZpcnN0O1xuICAgIHdoaWxlKGN1cnIgIT0gbnVsbCkge1xuICAgICAgZihjdXJyLmRhdGEpO1xuICAgICAgY3VyciA9IGN1cnIubmV4dDtcbiAgICAgIGkrKztcbiAgICB9XG4gIH1cblxuICBzcGxpdEF0KGluZGV4OiBudW1iZXIsICBzcGxpdDogUGFpcjxMaW5lPikge1xuICAgIC8vIFRPRE8oYXV0b21hdHdvbik6IERpc2FibGUgdGhlc2UgZGVmZW5zaXZlIGNoZWNrcyBmb3IgcGVyZm9ybWFuY2VcbiAgICBpZihpbmRleCA8IDApIHtcbiAgICAgIHRocm93IEVycm9yKCk7XG4gICAgfVxuICAgIGlmKHRoaXMuZmlyc3QgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgRXJyb3IoJ0ludmFsaWQgaW5kZXgnKTtcbiAgICB9XG4gICAgaWYodGhpcy5maXJzdC5uZXh0ID09IG51bGwgJiYgaW5kZXggIT0gMCkge1xuICAgICAgdGhyb3cgRXJyb3IoJ0luZGV4IERORScpO1xuICAgIH1cbiAgICBpZihpbmRleCA+PSB0aGlzLmxlbmd0aCgpKSB7XG4gICAgICB0aHJvdyBFcnJvcignSW5kZXggb3V0IGJvdW5kcycpO1xuICAgIH1cbiAgICBcbiAgICAvLyBSZXBsYWNlIG9uZSBlbGVtZW50IHdpdGggdHdvXG4gICAgdGhpcy5sZW5ndGhfKys7XG5cbiAgICAvLyBMaW5rIHRoZSBlbGVtZW50c1xuICAgIGNvbnN0IGxlZnROb2RlID0gbmV3IE5vZGUoc3BsaXQueCk7XG4gICAgY29uc3QgcmlnaHROb2RlID0gbmV3IE5vZGUoc3BsaXQueSk7XG4gICAgbGVmdE5vZGUubmV4dCA9IHJpZ2h0Tm9kZTtcbiAgICByaWdodE5vZGUucHJldiA9IGxlZnROb2RlO1xuXG4gICAgaWYodGhpcy5maXJzdC5uZXh0ID09IG51bGwpIHsgLy8gMSBlbGVtZW50XG4gICAgICB0aGlzLmZpcnN0ID0gbGVmdE5vZGU7XG4gICAgICB0aGlzLmxhc3QgPSByaWdodE5vZGU7XG4gICAgfSBlbHNlIGlmKGluZGV4ID09IDApIHsgLy8gRmlyc3QgRWxlbWVudFxuICAgICAgY29uc3QgbmV4dCA9IHRoaXMuZmlyc3QubmV4dFxuICAgICAgcmlnaHROb2RlLm5leHQgPSBuZXh0O1xuICAgICAgdGhpcy5maXJzdCA9IGxlZnROb2RlO1xuICAgICAgbmV4dC5wcmV2ID0gcmlnaHROb2RlO1xuICAgIH0gZWxzZSBpZihpbmRleCA9PSB0aGlzLmxlbmd0aCgpIC0gMikgeyAvLyBsYXN0IGVsZW1lbnQgXG4gICAgICB0aGlzLmxhc3QucHJldi5uZXh0ID0gbGVmdE5vZGU7XG4gICAgICBsZWZ0Tm9kZS5wcmV2ID0gdGhpcy5sYXN0LnByZXY7ICAgICAgXG4gICAgICB0aGlzLmxhc3QgPSByaWdodE5vZGU7XG4gICAgfSBlbHNlIHsgLy8gbWlkZGxlIGNhc2VcbiAgICAgIGxldCBjdXJyIDogTm9kZSA9IHRoaXMuZ2V0Tm9kZShpbmRleCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHByZXYgPSBjdXJyLnByZXY7XG4gICAgICBjb25zdCBuZXh0ID0gY3Vyci5uZXh0O1xuICAgICAgbGVmdE5vZGUucHJldiA9IHByZXY7XG4gICAgICByaWdodE5vZGUubmV4dCA9IG5leHQ7XG5cbiAgICAgIHByZXYubmV4dCA9IGxlZnROb2RlOyAgICAgICAgXG4gICAgICBuZXh0LnByZXYgPSByaWdodE5vZGU7XG4gICAgfVxuICB9XG59IiwiLy8vPHJlZmVyZW5jZSBwYXRoPVwicDUuZC50c1wiIC8+XG5cbmltcG9ydCB7VGVycmFpbkdlbmVyYXRvcn0gZnJvbSAnLi90ZXJyYWluLWdlbmVyYXRvcic7XG5pbXBvcnQgeyBTY3JvbGxpbmdNaWRwb2ludERpc3BsYWNlckxpbmtlZExpc3QgfSBmcm9tICcuL3Njcm9sbGluZy1taWRwb2ludC1kaXNwbGFjZXItbGlua2VkbGlzdCc7XG5cbmNvbnN0IHNrZXRjaCA9IGZ1bmN0aW9uIChwIDogcDUpIHtcbiAgY29uc3QgVyA6IG51bWJlciA9IDIwMDA7XG4gIGNvbnN0IEggOiBudW1iZXIgPSA0MDA7XG5cbiAgY29uc3QgbWluaW11bVc6IG51bWJlciA9IDY0MDtcbiAgY29uc3QgbWF4aW11bUg6IG51bWJlciA9IE1hdGgucm91bmQoSCAqLjgpO1xuXG4gIGNvbnN0IG1kcCA6IFRlcnJhaW5HZW5lcmF0b3IgPSBuZXcgU2Nyb2xsaW5nTWlkcG9pbnREaXNwbGFjZXJMaW5rZWRMaXN0KG1pbmltdW1XLCBtYXhpbXVtSCk7XG5cbiAgcC5zZXR1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICBwLmNyZWF0ZUNhbnZhcyhXLCBIKTtcbiAgICBwLnN0cm9rZVdlaWdodCgyKTtcbiAgICBwLmZyYW1lUmF0ZSgyMCk7XG4gIH07XG5cbiAgcC5kcmF3ID0gZnVuY3Rpb24oKSB7XG4gICAgcC5iYWNrZ3JvdW5kKHAuY29sb3IoJ2JsYWNrJykpO1xuXG4gICAgcC5zdHJva2UocC5jb2xvcig5OCwgMjAzLCAxNTcpKTtcbiAgICBtZHAudXBkYXRlKCk7IFxuICAgIG1kcC5yZW5kZXIocCk7XG5cbiAgICBwLnN0cm9rZShwLmNvbG9yKCd3aGl0ZScpKTtcbiAgICBwLmxpbmUobWluaW11bVcsIDAsIG1pbmltdW1XLCBIKTtcbiAgfTtcbn07XG5cbi8vIFRPRE8oZnJlZWZvb2QpOiBmaXggZGF0YS5qc29uIHRvIGhhdmUgbW9yZSBleHBsaWNpdCB0eXBlIFxubmV3IHA1KHNrZXRjaCwgZmFsc2UsIGZhbHNlKTsiLCIvKipcbiAqIGNsYXNzIHRvIHJlcHJlc2VudCBwYWlyIG9mIFRzXG4gKlxuICovXG5cbmV4cG9ydCBjbGFzcyBQYWlyPFQ+IHtcbiAgICBwdWJsaWMgeCA6IFQ7XG4gICAgcHVibGljIHkgOiBUO1xuICAgIGNvbnN0cnVjdG9yKHg6IFQsIHk6IFQpIHtcbiAgICAgICAgdGhpcy54ID0geDtcbiAgICAgICAgdGhpcy55ID0geTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBgUGFpcigke3RoaXMueH0sJHt0aGlzLnl9KWA7XG4gICAgfVxuICAgIFxuICAgIHB1YmxpYyBzaGFsbG93Q2xvbmUoKSA6IFBhaXI8VD4ge1xuICAgICAgICByZXR1cm4gbmV3IFBhaXIodGhpcy54LCB0aGlzLnkpO1xuICAgIH1cbn0iLCIvLy88cmVmZXJlbmNlIHBhdGg9XCJwNS5kLnRzXCIgLz5cbi8qKlxuICogQ2xhc3MgdG8gbWFuYWdlIHN0YXRlIG9mIHNjcm9sbGluZyB0ZXJyYWluIHdpdGggZG91Ymx5LWxpbmtlZCBsaXN0IHF1ZXVlIHRoYXQgcHJvZ3Jlc3NpdmVseSBidWZmZXJzIG1vcmUgXG4gKiBsaW5lcyBcblxuICovXG5cbmltcG9ydCB7UGFpcn0gZnJvbSAnLi9wYWlyJztcbmltcG9ydCB7U3BsaXR0YWJsZUxpbmV9IGZyb20gJy4vc3BsaXR0YWJsZS1saW5lJztcbmltcG9ydCB7TGlua2VkTGlzdH0gZnJvbSAnLi9saW5rZWQtbGlzdCc7XG5cbmV4cG9ydCBjbGFzcyBTY3JvbGxpbmdNaWRwb2ludERpc3BsYWNlckxpbmtlZExpc3Qge1xuICBzdGF0aWMgUk9VR0hORVNTIDogbnVtYmVyID0gLjg7XG5cbiAgLy8gVE9ETyhhdXRvbWF0d29uKTogdGhpcyBpcyBwcm9iYWJseSBtb3JlIGVmZmljaWVudGx5IHJlcHJlc2VudGVkIGFzIHNlcXVlbmNlXG4gIC8vIG9mIHBvaW50cy4gQnV0IGVhc2llciB0byBpbXBsZW1lbnQgd2l0aCBTcGxpdHRhYmxlTGluZXMgZm9yIG5vd1xuICBwcml2YXRlIGxpbmVTZWdtZW50czogTGlua2VkTGlzdDtcbiAgcHJpdmF0ZSBiYXNlRGlzcGxhY2VtZW50OiBudW1iZXI7XG4gIHByaXZhdGUgdmVydGljYWxCb3VuZDogUGFpcjxudW1iZXI+O1xuXG4gIHByaXZhdGUgaXRlcmF0aW9uczogbnVtYmVyO1xuICBwcml2YXRlIGVucXVldWVJbnRlcnZhbDogbnVtYmVyO1xuXG4gIC8vIE51bWJlciBvZiBwYXJ0cyB3ZSBwYXJ0aXRpb24gZWFjaCBsaW5lIGludG9cbiAgc3RhdGljIFBPV0VSOiBudW1iZXIgPSAyO1xuICBzdGF0aWMgTUlOSU1VTV9MSU5FX1dJRFRIOiBudW1iZXIgPSAyO1xuICBzdGF0aWMgTUFYX0dFTkVSQVRJT05TOiBudW1iZXIgPSA3O1xuICBzdGF0aWMgSU5JVElBTF9MSU5FX1dJRFRIOiBudW1iZXIgPSAoXG4gICAgU2Nyb2xsaW5nTWlkcG9pbnREaXNwbGFjZXJMaW5rZWRMaXN0Lk1JTklNVU1fTElORV9XSURUSCAqXG4gICAgICBTY3JvbGxpbmdNaWRwb2ludERpc3BsYWNlckxpbmtlZExpc3QuUE9XRVIgKipcbiAgICAoU2Nyb2xsaW5nTWlkcG9pbnREaXNwbGFjZXJMaW5rZWRMaXN0Lk1BWF9HRU5FUkFUSU9OUy0xKVxuICApO1xuXG4gIGNvbnN0cnVjdG9yKG1pbmltdW1XaWR0aDogbnVtYmVyLCBtYXhpbXVtSGVpZ2h0OiBudW1iZXIpIHtcbiAgICB0aGlzLnZlcnRpY2FsQm91bmQgPSBuZXcgUGFpcigwLCBtYXhpbXVtSGVpZ2h0KTtcblxuICAgIGNvbnN0IGxpbmVzIDogTGlua2VkTGlzdCA9IG5ldyBMaW5rZWRMaXN0KCk7XG4gICAgdGhpcy5saW5lU2VnbWVudHMgPSBsaW5lcztcblxuICAgIGNvbnN0IHAxIDogUGFpcjxudW1iZXI+PSBuZXcgUGFpcigwLCAxNTApO1xuICAgIGNvbnN0IHAyIDogUGFpcjxudW1iZXI+PSBuZXcgUGFpcihTY3JvbGxpbmdNaWRwb2ludERpc3BsYWNlckxpbmtlZExpc3QuSU5JVElBTF9MSU5FX1dJRFRILCAyNTApO1xuICAgIGNvbnN0IGJhc2VEaXNwbGFjZW1lbnQgPSBwMS55IC0gcDIueTtcbiAgICBjb25zdCBsIDogU3BsaXR0YWJsZUxpbmUgPSBuZXcgU3BsaXR0YWJsZUxpbmUocDEsIHAyLCAwLCAgYmFzZURpc3BsYWNlbWVudCk7XG4gICAgbGluZXMucHVzaChsKTtcblxuICAgIC8vIEFkZCBlbm91Z2ggaW5pdGlhbCBsaW5lIHNlZ21lbnRzIHNvIHRoZXJlIGlzIGFsd2F5cyBlbm91Z2ggY29tcGxldGVseSBzcGxpdCBsaW5lIHNlZ21lbnRzIGluIHZpZXdhYmxlIGFyZWFcbiAgICBjb25zdCBudW1CYXNlTGluZVNlZ21lbnRzID0gbWluaW11bVdpZHRoIC8gU2Nyb2xsaW5nTWlkcG9pbnREaXNwbGFjZXJMaW5rZWRMaXN0LklOSVRJQUxfTElORV9XSURUSDtcbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgbnVtQmFzZUxpbmVTZWdtZW50czsgaSsrKSB7XG4gICAgICB0aGlzLmVucXVldWUoKTtcbiAgICB9XG4gICAgXG4gICAgLy8gTnVtYmVyIG9mIGl0ZXJ0aW9ucyBiZWZvcmUgZW5xdWV1ZVxuICAgIHRoaXMuZW5xdWV1ZUludGVydmFsID0gU2Nyb2xsaW5nTWlkcG9pbnREaXNwbGFjZXJMaW5rZWRMaXN0LlBPV0VSICoqIChTY3JvbGxpbmdNaWRwb2ludERpc3BsYWNlckxpbmtlZExpc3QuTUFYX0dFTkVSQVRJT05TIC0gMSk7XG5cbiAgICAvLyBFbnN1cmUgYWxsIGxpbmUgc2VnbWVudHMgb3JpZ2luYWxseSBkaXNwbGFjZWQgLyBzcGxpdCBhcyBtdWNoIGFzIHBvc3NpYmxlXG4gICAgZm9yKGxldCBpID0gMCA7IGkgPCBTY3JvbGxpbmdNaWRwb2ludERpc3BsYWNlckxpbmtlZExpc3QuTUFYX0dFTkVSQVRJT05TOyBpKyspIHtcbiAgICAgIHRoaXMuZGlzcGxhY2UoKTtcbiAgICB9XG5cbiAgICB0aGlzLml0ZXJhdGlvbnMgPSAwO1xuICB9XG5cbiAgcHVibGljIHJlbmRlcihwOiBwNSkge1xuICAgIHRoaXMubGluZVNlZ21lbnRzLmZvckVhY2goKGw6IFNwbGl0dGFibGVMaW5lKSA9PiB7XG4gICAgICAgcC5saW5lKGwuYS54LCBsLmEueSwgbC5iLngsIGwuYi55KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIEFkZCBhIHVuZGlzcGxhY2VkIGxpbmUgc2VnbWVudCB0aGF0IHN0YXJ0cyBmcm9tIHByZXZpb3VzIGxpbmUgc2VnbWVudFxuICBwdWJsaWMgZW5xdWV1ZSgpIHtcbiAgICBjb25zdCBsYXN0IDogU3BsaXR0YWJsZUxpbmUgPSB0aGlzLmxpbmVTZWdtZW50cy5wZWVrTGFzdCgpO1xuICAgIGNvbnN0IGJlZ2luQ29vcmRpbmF0ZSA9IG5ldyBQYWlyKGxhc3QuYi54ICsgMCwgbGFzdC5iLnkgKyAwKTsgXG4gICAgY29uc3QgZW5kQ29vcmRpbmF0ZSA9IG5ldyBQYWlyKGJlZ2luQ29vcmRpbmF0ZS54ICtcbiAgICAgIFNjcm9sbGluZ01pZHBvaW50RGlzcGxhY2VyTGlua2VkTGlzdC5JTklUSUFMX0xJTkVfV0lEVEgsIE1hdGguZmxvb3IodGhpcy52ZXJ0aWNhbEJvdW5kLnkgKiBNYXRoLnJhbmRvbSgpKSk7XG4gICAgY29uc3QgbmV3TGluZSA9IG5ldyBTcGxpdHRhYmxlTGluZShiZWdpbkNvb3JkaW5hdGUsIGVuZENvb3JkaW5hdGUsIDAsIGJlZ2luQ29vcmRpbmF0ZS55IC0gZW5kQ29vcmRpbmF0ZS55KTtcbiAgICB0aGlzLmxpbmVTZWdtZW50cy5wdXNoKG5ld0xpbmUpO1xuICB9XG5cbiAgLy8gUGVyZm9ybSBhIHNpbmdsZSBwYXNzIG9mIG1pZHBvaW50IGRpc3BsYWNlbWVudCBvdmVyIGV2ZXJ5IGxpbmUgc2VnbWVudFxuICBwdWJsaWMgZGlzcGxhY2UoKSB7XG4gICAgY29uc3QgbGluZXMgPSB0aGlzLmxpbmVTZWdtZW50cztcbiAgICBsZXQgaSA9IHRoaXMubGluZVNlZ21lbnRzLmxlbmd0aCgpIC0gMTsgICAgXG4gICAgd2hpbGUoaSA+PSAwKSB7XG4gICAgICBjb25zdCBsIDogU3BsaXR0YWJsZUxpbmUgPSBsaW5lcy5nZXQoaSk7XG4gICAgICAvLyBUT0RPKGF1dG9tYXR3b24pOiBjb25zaWRlciBkcm9wcGluZyB0aGlzIGlmIHdlIGFyZSB1c2luZyBzZXQgb2YgcG9pbnRzLFxuICAgICAgLy8gaW5zdGVhZCBvZiBsaW5lIHNlZ21lbnRzLCB3aGVyZSB3ZSBjYW4gY29tcGFyZSBhZGphY2VudCBwYWlyc1xuICAgICAgaWYoIVNjcm9sbGluZ01pZHBvaW50RGlzcGxhY2VyTGlua2VkTGlzdC5za2lwU3BsaXR0YWJsZUxpbmUobCkpIHtcbiAgICAgICAgY29uc3Qgc3BsaXQgOiBQYWlyPFNwbGl0dGFibGVMaW5lPiA9IGwuZ2V0U3BsaXQodGhpcy52ZXJ0aWNhbEJvdW5kKTtcbiAgICAgICAgbGluZXMuc3BsaXRBdChpLCBzcGxpdCk7XG4gICAgICB9XG4gICBcbiAgICAgIGktLTtcbiAgICB9XG4gIH1cblxuICAvLyBTaGlmdHMgYWxsIHRoZSBsaW5lIHNlZ21lbnRzIGhvcml6b250YWxseVxuICBwdWJsaWMgc2Nyb2xsKCkge1xuICAgIGNvbnN0IGRlbHRhWCA9IFNjcm9sbGluZ01pZHBvaW50RGlzcGxhY2VyTGlua2VkTGlzdC5NSU5JTVVNX0xJTkVfV0lEVEg7XG4gICAgdGhpcy5saW5lU2VnbWVudHMuZm9yRWFjaCgobDogU3BsaXR0YWJsZUxpbmUpID0+IHtcbiAgICAgIGwudHJhbnNsYXRlKC0xKmRlbHRhWCwgMCk7XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgdXBkYXRlKCkge1xuICAgIHRoaXMuaXRlcmF0aW9ucysrO1xuICAgICAgXG4gICAgLy8gRGVxdWV1ZSBlYXJsaWVzdCBsaW5lIHNlZ21lbnRzXG4gICAgdGhpcy5saW5lU2VnbWVudHMucG9wKCk7XG5cbiAgICB0aGlzLmRpc3BsYWNlKCk7XG5cbiAgICAvLyBFbnF1ZXVlIG5ldyB1bmRpc3BsYWNlZCBsaW5lXG4gICAgaWYodGhpcy5pdGVyYXRpb25zICUgdGhpcy5lbnF1ZXVlSW50ZXJ2YWwgPT0gMCkge1xuICAgICAgICB0aGlzLmVucXVldWUoKTtcbiAgICB9XG5cbiAgICB0aGlzLnNjcm9sbCgpO1xuICB9XG5cbiAgLy8gQ29uZGl0aW9uIHRvIHN0b3AgbG9vcGluZ1xuICBzdGF0aWMgc2tpcFNwbGl0dGFibGVMaW5lKGwgOiBTcGxpdHRhYmxlTGluZSkgOiBib29sZWFuIHtcbiAgICByZXR1cm4gbC5nZXRHZW5lcmF0aW9uKCkgPj0gU2Nyb2xsaW5nTWlkcG9pbnREaXNwbGFjZXJMaW5rZWRMaXN0Lk1BWF9HRU5FUkFUSU9OUyAtIDE7XG4gIH1cbn0iLCJpbXBvcnQge1BhaXJ9IGZyb20gJy4vcGFpcic7XG5cbi8qKlxuICogY2xhc3MgdG8gcmVwcmVzZW50IExpbmUgc2VnbWVudCB3aXRoIGFkZGl0aW9uYWwgZGF0YSBmb3IgbWlkcG9pbnQgZGlzcGxhY2VtZW50IHNwbGl0dGluZ1xuICovXG5cbmV4cG9ydCBjbGFzcyBTcGxpdHRhYmxlTGluZSB7XG4gIHN0YXRpYyBST1VHSE5FU1M6IG51bWJlciA9IC42O1xuICBwdWJsaWMgYTogUGFpcjxudW1iZXI+O1xuICBwdWJsaWMgYjogUGFpcjxudW1iZXI+O1xuICBwcml2YXRlIGdlbmVyYXRpb246IG51bWJlcjtcbiAgcHJpdmF0ZSBiYXNlRGlzcGxhY2VtZW50OiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IoYTogUGFpcjxudW1iZXI+LCBiOiBQYWlyPG51bWJlcj4sIGdlbmVyYXRpb246IG51bWJlciwgYmFzZURpc3BsYWNlbWVudDogbnVtYmVyKSB7XG4gICAgdGhpcy5hID0gYTtcbiAgICB0aGlzLmIgPSBiO1xuICAgIHRoaXMuZ2VuZXJhdGlvbiA9IGdlbmVyYXRpb247XG4gICAgdGhpcy5iYXNlRGlzcGxhY2VtZW50ID0gYmFzZURpc3BsYWNlbWVudDtcbiAgfVxuXG4gIHB1YmxpYyB0b1N0cmluZygpIHtcbiAgICByZXR1cm4gYExpbmUoJHt0aGlzLmEudG9TdHJpbmcoKX0tPiR7dGhpcy5iLnRvU3RyaW5nKCl9KWA7XG4gIH1cblxuICBwdWJsaWMgZ2V0TWlkcG9pbnQoKSA6IFBhaXI8bnVtYmVyPiB7XG4gICAgY29uc3QgeCA9ICh0aGlzLmIueCArIHRoaXMuYS54KSAvIDI7XG4gICAgY29uc3QgeSA9ICh0aGlzLmIueSArIHRoaXMuYS55KSAvIDI7XG4gICAgcmV0dXJuIG5ldyBQYWlyPG51bWJlcj4oeCwgeSk7XG4gIH1cblxuICBwdWJsaWMgbmV4dERpc3BsYWNlbWVudE1hZ25pdHVkZSgpIDogbnVtYmVyIHtcbiAgICBjb25zdCBiYXNlRGlzcGxhY2VtZW50U2NhbGUgPSAyICoqICgtMSpTcGxpdHRhYmxlTGluZS5ST1VHSE5FU1MpO1xuICAgIGNvbnN0IGRpc3BsYWNlbWVudFNjYWxlID0gIGJhc2VEaXNwbGFjZW1lbnRTY2FsZSoqdGhpcy5nZW5lcmF0aW9uO1xuICAgIHJldHVybiB0aGlzLmJhc2VEaXNwbGFjZW1lbnQgKiBkaXNwbGFjZW1lbnRTY2FsZTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRHZW5lcmF0aW9uKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGlvbjtcbiAgfVxuXG4gIHB1YmxpYyBnZXRCYXNlRGlzcGxhY2VtZW50KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuYmFzZURpc3BsYWNlbWVudDtcbiAgfVxuXG4gIHB1YmxpYyBnZXRTcGxpdCh2ZXJ0aWNhbEJvdW5kOiBQYWlyPG51bWJlcj4pOiBQYWlyPFNwbGl0dGFibGVMaW5lPiB7XG4gICAgY29uc3QgZGlzcGxhY2VtZW50TWFnbml0dWRlID0gdGhpcy5uZXh0RGlzcGxhY2VtZW50TWFnbml0dWRlKCk7XG4gICAgY29uc3QgbGVmdFBvaW50IDogUGFpcjxudW1iZXI+ID0gdGhpcy5hO1xuICAgIGNvbnN0IHJpZ2h0UG9pbnQgOiBQYWlyPG51bWJlcj49IHRoaXMuYjtcblxuICAgIC8vIENvbXB1dGUgZGlzcGxhY2VkIG1pZHBvaW50XG4gICAgY29uc3QgbWlkcG9pbnQgOiBQYWlyPG51bWJlcj4gPSB0aGlzLmdldE1pZHBvaW50KCk7XG4gICAgY29uc3QgdmVydGljYWxseURpc3BsYWNlZE1pZHBvaW50QSA6IFBhaXI8bnVtYmVyPiA9IHRoaXMuZGlzcGxhY2VQb2ludFZlcnRpY2FsbHkoXG4gICAgICBtaWRwb2ludCwgZGlzcGxhY2VtZW50TWFnbml0dWRlLCB2ZXJ0aWNhbEJvdW5kKTtcbiAgICBjb25zdCB2ZXJ0aWNhbGx5RGlzcGxhY2VkTWlkcG9pbnRCIDogUGFpcjxudW1iZXI+ID0gdmVydGljYWxseURpc3BsYWNlZE1pZHBvaW50QS5zaGFsbG93Q2xvbmUoKTtcblxuICAgIGNvbnN0IGdlbmVyYXRpb24gPSB0aGlzLmdldEdlbmVyYXRpb24oKSArIDE7XG4gICAgY29uc3QgYmFzZURpc3BsYWNlbWVudCA9IHRoaXMuZ2V0QmFzZURpc3BsYWNlbWVudCgpO1xuICAgIGNvbnN0IGxlZnRTcGxpdHRhYmxlTGluZSA6IFNwbGl0dGFibGVMaW5lID0gbmV3IFNwbGl0dGFibGVMaW5lKGxlZnRQb2ludCwgdmVydGljYWxseURpc3BsYWNlZE1pZHBvaW50QSwgZ2VuZXJhdGlvbiwgYmFzZURpc3BsYWNlbWVudCk7XG4gICAgY29uc3QgcmlnaHRTcGxpdHRhYmxlTGluZSA6IFNwbGl0dGFibGVMaW5lID0gbmV3IFNwbGl0dGFibGVMaW5lKHZlcnRpY2FsbHlEaXNwbGFjZWRNaWRwb2ludEIsIHJpZ2h0UG9pbnQsIGdlbmVyYXRpb24sIGJhc2VEaXNwbGFjZW1lbnQpO1xuXG4gICAgcmV0dXJuIG5ldyBQYWlyKGxlZnRTcGxpdHRhYmxlTGluZSwgcmlnaHRTcGxpdHRhYmxlTGluZSk7XG4gIH1cblxuICAgcHJpdmF0ZSBkaXNwbGFjZVBvaW50VmVydGljYWxseShwOiBQYWlyPG51bWJlcj4sIGRpc3BsYWNlTWFnbml0dWRlOiBudW1iZXIsIHZlcnRpY2FsQm91bmQ6IFBhaXI8bnVtYmVyPikgOiBQYWlyPG51bWJlcj57XG4gICAgbGV0IHkgPSBwLnkgKyB0aGlzLmNob29zZShbZGlzcGxhY2VNYWduaXR1ZGUsIC1kaXNwbGFjZU1hZ25pdHVkZV0pO1xuICAgIFxuICAgIC8vIEJvdW5kIHRoZSB2YWx1ZSB0byB3aXRoaW4gd2luZG93XG4gICAgeSA9IHRoaXMuY2xhbXAoeSwgdmVydGljYWxCb3VuZC54LCB2ZXJ0aWNhbEJvdW5kLnkpO1xuXG4gICAgcmV0dXJuIG5ldyBQYWlyKHAueCwgeSk7XG4gIH1cblxuICAgIC8vIFByaXZhdGUgc3RhdGljIGZpbmFsOiBtb3ZlIGludG8gdXRpbGl0eSBvciBnbG9iYWwuZC50c1xuICBwcml2YXRlIGNob29zZShjaG9pY2VzOiBBcnJheTxhbnk+KSB7XG4gICAgcmV0dXJuIGNob2ljZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY2hvaWNlcy5sZW5ndGgpXTtcbiAgfVxuXG4gIHByaXZhdGUgY2xhbXAoeDogbnVtYmVyLCBsb3dlckJvdW5kOiBudW1iZXIsIHVwcGVyQm91bmQ6IG51bWJlcikge1xuICAgIHJldHVybiBNYXRoLm1pbih1cHBlckJvdW5kLCBNYXRoLm1heCh4LCBsb3dlckJvdW5kKSk7XG4gIH1cblxuICBwdWJsaWMgdHJhbnNsYXRlKHg6IG51bWJlciwgeTogbnVtYmVyKSB7XG4gICAgdGhpcy5hLnggKz0geDtcbiAgICB0aGlzLmEueSArPSB5O1xuICAgIHRoaXMuYi54ICs9IHg7XG4gICAgdGhpcy5iLnkgKz0geTtcbiAgfVxufSJdfQ==